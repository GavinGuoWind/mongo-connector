<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:lang="http://www.springframework.org/schema/lang"
	xmlns:p="http://www.springframework.org/schema/p" xmlns:util="http://www.springframework.org/schema/util"
	xmlns:mongo="http://www.springframework.org/schema/data/mongo"
	xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
		http://www.springframework.org/schema/lang http://www.springframework.org/schema/lang/spring-lang-3.0.xsd
		http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util-3.0.xsd
		http://www.springframework.org/schema/data/mongo http://www.springframework.org/schema/data/mongo/spring-mongo.xsd">

	<mongo:mongo id="com.despegar.integration.mongo.db"
		replica-set="${com.despegar.integration.mongo.replicaSet}">
		<mongo:options slave-ok="${com.despegar.integration.mongo.slaveOk:false}"
			connections-per-host="${com.despegar.integration.mongo.connectionsPerHost:100}" />
	</mongo:mongo>

	<alias alias="objectMapper.alias"
		name="${com.despegar.integration.mongo.objectMapper:com.despegar.integration.mongo.default.objectMapper}" />

	<bean id="com.despegar.integration.mongo.factory" class="com.despegar.integration.mongo.support.MongoDaoFactory"
		p:dbName="${com.despegar.integration.mongo.dbName}" p:mapper-ref="objectMapper.alias"
		p:mongoDBConnection-ref="com.despegar.integration.mongo.db" />

	<bean id="com.despegar.integration.mongo.default.objectMapper"
		class="com.fasterxml.jackson.databind.ObjectMapper" />
		
	<bean id="com.despegar.integration.mongo.id.generator.long"
		class="com.despegar.integration.mongo.id.LongIdGenerator"
		p:mongoDb-ref="com.despegar.integration.mongo.db" 
		p:countersCollectionName="${com.despegar.integration.mongo.counters:counters}"/>
			
	<bean id="com.despegar.integration.mongo.id.generator.string"
		class="com.despegar.integration.mongo.id.StringIdGenerator" />
</beans>
